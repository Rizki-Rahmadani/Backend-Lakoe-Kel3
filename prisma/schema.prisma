generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String       @id @unique @default(cuid())
  email        String       @unique
  phone_number String?      @unique
  fullname     String
  password     String
  role_id      Roles?       @relation(fields: [rolesId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  profile_id   Profiles?
  profilesId   String?
  rolesId      String?
  Carts        Carts[]
  Cart_items   Cart_items[]
  Invoices     Invoices[]
  Payments     Payments[]
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  store        Stores?      @relation
}

model Profiles {
  id         String     @id @unique @default(cuid())
  user_id    String     @unique
  locations  Location[]
  User       User       @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  locationId String     @unique
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
}

model Roles {
  id        String   @id @unique @default(cuid())
  name      String?
  User      User[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id            String       @id @unique @default(cuid())
  name          String
  description   String?
  attachments   String
  is_active     Boolean?     @default(false)
  variants      Variants[]
  size          String?
  minimum_order Int?
  store_id      Stores?      @relation(fields: [storesId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  storesId      String?
  Categories    Categories[]
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
}

model Stores {
  id                    String                  @id @unique @default(cuid())
  name                  String
  username              String                  @unique
  slogan                String?
  description           String?
  domain                String?
  logo_attachment       String?
  banner_attachment     String?
  Product               Product[]
  bank_accounts         bank_accounts[]
  Location              Location[]
  Carts                 Carts[]
  Cart_items            Cart_items[]
  Stores_on_decorations Stores_on_decorations[]
  Operation_hours       Operation_hours[]
  Message_templates     Message_templates[]
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  user                  User                    @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId                String                  @unique
}

model bank_accounts {
  id         String   @id @unique @default(cuid())
  bank       String
  acc_number String
  acc_name   String
  store_id   Stores?  @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  storesId   String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Location {
  id               String    @id @unique @default(cuid())
  name             String
  address          String
  postal_code      String
  city_district    String
  store_id         Stores?   @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  profile_id       Profiles? @relation(fields: [profilesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  is_main_location Boolean?  @default(false)
  longitude        String
  latitude         String
  storesId         String?
  profilesId       String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
}

model Variant_option_values {
  id                String          @id @unique @default(cuid())
  sku               String
  weight            Int
  stock             Int
  price             Int
  is_active         Boolean         @default(false)
  variant_option_id Variant_options @relation(fields: [variant_optionsId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  variant_optionsId String
  Cart_items        Cart_items[]
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
}

model Variant_options {
  id                    String                  @id @unique @default(cuid())
  name                  String
  variant_id            Variants                @relation(fields: [variantsId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  Variant_option_values Variant_option_values[]
  variantsId            String
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
}

model Variants {
  id              String            @id @unique @default(cuid())
  name            String
  is_active       Boolean           @default(false)
  product_id      Product           @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  Variant_options Variant_options[]
  productId       String
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
}

model Categories {
  id        String       @id @unique @default(cuid())
  name      String
  products  Product[]
  parentId  String?
  parent    Categories?  @relation("CategoryParent", fields: [parentId], references: [id])
  children  Categories[] @relation("CategoryParent")
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
}

model Carts {
  id         String       @id @unique @default(cuid())
  prices     Int
  discount   Int?
  user_id    User         @relation(fields: [userId], references: [id])
  store_id   Stores       @relation(fields: [storesId], references: [id])
  userId     String
  storesId   String
  Cart_items Cart_items[]
  Invoices   Invoices[]
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
}

model Cart_items {
  id                      String                @id @unique @default(cuid())
  qty                     Int
  price                   Int
  cart_id                 Carts                 @relation(fields: [cartsId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  user_id                 User                  @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  store_id                Stores                @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  variant_option_value_id Variant_option_values @relation(fields: [variant_option_valuesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  cartsId                 String
  userId                  String
  storesId                String
  variant_option_valuesId String
  createdAt               DateTime              @default(now())
  updatedAt               DateTime              @updatedAt
}

model Invoices {
  id                   String                 @id @unique @default(cuid())
  prices               Int
  status               Boolean                @default(false)
  receiver_longitude   String
  receiver_latitude    String
  receiver_district    String
  receiver_phone       String
  receiver_address     String
  receiver_name        String
  invoice_number       String
  cart_id              Carts                  @relation(fields: [cartsId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  user_id              User                   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  payment_id           Payments?              @relation(fields: [paymentsId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  courier_id           Couriers?
  cartsId              String
  userId               String
  paymentsId           String                 @unique
  courierId            String
  Confirmation_payment Confirmation_payment[]
  Invoice_histories    Invoice_histories[]
  createdAt            DateTime               @default(now())
  updatedAt            DateTime               @updatedAt
}

model Confirmation_payment {
  id         String   @id @unique @default(cuid())
  amount     Int
  bank       String
  invoice_id Invoices @relation(fields: [invoicesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  invoicesId String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Invoice_histories {
  id         String    @id @unique @default(cuid())
  status     Boolean   @default(false)
  invoice_id Invoices  @relation(fields: [invoicesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  created_at DateTime? @default(now())
  invoicesId String
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}

model Payments {
  id                   String    @id @unique @default(cuid())
  bank                 String
  amount               Int
  status               Boolean   @default(false)
  invoice_id           Invoices? @relation
  user_id              User      @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  moota_transaction_id String?
  userId               String
  invoicesId           String    @unique
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
}

model Couriers {
  id                   String   @id @unique @default(cuid())
  courier_code         String
  courier_service_name String
  courier_service_code String
  price                Int
  invoice_id           Invoices @relation(fields: [invoicesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  order_id             String
  invoicesId           String   @unique
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
}

model Decoration {
  id        String   @id @unique @default(cuid())
  type      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Stores_on_decorations {
  id        String   @id @unique @default(cuid())
  store_id  Stores   @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  storesId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Operation_hours {
  id        String   @id @unique @default(cuid())
  day       String
  open_at   String
  close_at  String
  is_off    Boolean
  store_id  Stores   @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  storesId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Message_templates {
  id        String   @id @unique @default(cuid())
  name      String
  content   String
  store_id  Stores   @relation(fields: [storesId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  storesId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
